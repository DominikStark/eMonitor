(function($){var muslider=[],instance=0,methods={init:function(options){this.each(function(){var defaults={width:"100%",height:"100%",max_width:0,max_height:0,reference_width:0,reference_height:0,min_width:320,min_height:180,ratio:.5625,animation_type:"horizontal",animation_duration:600,animation_start:"manual",animation_interval:4e3,responsive:"yes"},$obj=$(this),data=$obj.data("muslider"),$options=$(),$slide=$(),$navslide=$(),$start=$(),$stop=$(),$next=$(),$prev=$(),current=0,totslides=0,timer=0,margin=100,slider_ratio=.565,calc_width=0,calc_height=0;$options=$.extend(defaults,options);switch($options.responsive){case"yes":case true:case 1:default:$options.responsive=true;break;case"no":case false:case 0:$options.responsive=false;break}$obj.attr("data-id","muslider_"+instance);$slide=$obj.find(".slide");totslides=$slide.length-1;$slide.each(function(index){$(this).attr("id","slide"+instance+"_"+index)});$navslide=$obj.next(".navslide");$start=$navslide.find(".start").attr("data-id","start_"+instance);$stop=$navslide.find(".stop").attr("data-id","stop_"+instance);$next=$navslide.find(".next").attr("data-id","next_"+instance);$prev=$navslide.find(".prev").attr("data-id","prev_"+instance);if($options.responsive===false){if(typeof $options.height=="number"&&typeof $options.width=="number"){slider_ratio=$options.height/$options.width;calc_width=$options.width}else{calc_width=innum($options.width,$obj.parent().width())}}else{calc_width=innum($options.width,$obj.parent().width());if(typeof $options.ratio=="number"){slider_ratio=$options.ratio}else{switch($options.ratio){case"default":case"adjust":case"":default:slider_ratio=.5625;break;case"reference":if(typeof $options.reference_height==="number"&&typeof $options.reference_width==="number"&&$options.reference_width>0&&$options.reference_height>0){slider_ratio=$options.reference_height/$options.reference_width}break;case"maximum":if(typeof $options.max_height==="number"&&typeof $options.max_width==="number"&&$options.max_width>0&&$options.max_height>0){slider_ratio=$options.max_height/$options.max_width}break;case"initial":slider_ratio=getCookie("muslider_ratio");if(slider_ratio==null||slider_ratio=="undefined"){calc_width=innum($options.width,$(window).width());calc_height=innum($options.height,$(window).height());slider_ratio=calc_height/calc_width;setCookie("muslider_ratio",slider_ratio)}break;case"continuous":calc_width=innum($options.width,$(window).width());calc_height=innum($options.height,$(window).height());slider_ratio=calc_height/calc_width;break}}}calc_height=Math.round(calc_width*slider_ratio);if($options.animation_type=="fade"){calc_width="100%";calc_height="100%"}if($options.animation_type=="horizonzal"){calc_height="100%"}$slide.css({"box-sizing":"content-box",width:calc_width,height:calc_height,top:0,left:0});if(typeof $slide.children("img").attr("data-src")!="undefined"&&$slide.children("img").attr("src")!=$slide.children("img").attr("data-src")){var loader_src=$slide.children("img").attr("src");$slide.children("img").css({background:"url("+loader_src+") no-repeat center center"})}$slide.children("img,video,iframe").css({"box-sizing":"content-box",width:calc_width,height:calc_height});$slide.not(":first").hide();$slide.filter(":first").toggleClass("active");$obj.css({"box-sizing":"content-box",width:calc_width,height:calc_height});$obj.data("muslider",{slider:$obj,slide:$slide,totslides:totslides,margin:margin,navslide:$navslide,start:$start,stop:$stop,prev:$prev,next:$next,current:current,timer:timer,options:$options,instance:instance,slider_ratio:slider_ratio,calc_width:calc_width,calc_height:calc_height});load_image($obj.data("muslider"));$next.on("click",function(e){e.preventDefault();$.fn.muslider("next",$(this).attr("data-id"))});$prev.on("click",function(e){e.preventDefault();$.fn.muslider("prev",$(this).attr("data-id"))});$stop.on("click",function(e){e.preventDefault();$.fn.muslider("stop",$(this).attr("data-id"));$(this).hide();$start.show()});$start.on("click",function(e){e.preventDefault();$.fn.muslider("start",$(this).attr("data-id"));$(this).hide();$stop.show()});var mm={};var swipeTreshold=5;$(document).on("touchstart",$obj,function(e){if(e.originalEvent.touches==undefined){var touch=e}else{var touch=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]}mm.ox=touch.pageX;mm.oy=touch.pageY});$(document).on("touchend",$obj,function(e){if(e.originalEvent.touches==undefined){var touch=e}else{var touch=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0]}var elm=$(this).offset();mm.dx=touch.pageX-mm.ox;mm.dy=touch.pageY-mm.oy;if(mm.dx<-swipeTreshold){$next.trigger("click")}else if(mm.dx>swipeTreshold){$prev.trigger("click")}});data=$obj.data("muslider");muslider[instance]=data;if($options.responsive===true){$.fn.muslider("resize",instance)}if($options.animation_start=="auto"){$stop.show();$start.hide();$.fn.muslider("start",instance)}else if($options.animation_start=="manual"){$.fn.muslider("stop",instance);$stop.hide();$start.hide()}instance++;return muslider})},next:function(id){id=find_instance(id);var data=muslider[id],actual=data.current;data.current++;if(data.current>data.totslides){data.current=0}stop_multimedia(id,actual);load_image(data);animate_slide(data,actual,"n");animate_caption(data);muslider[id]=data;return muslider},prev:function(id){id=find_instance(id);var data=muslider[id],actual=data.current;data.current--;if(data.current<0){data.current=data.totslides}stop_multimedia(id,actual);load_image(data);animate_slide(data,actual,"p");animate_caption(data);muslider[id]=data;return muslider},resize:function(id){id=find_instance(id);var data=muslider[id];if(data.options.responsive===true){data=resize_slider(data)}muslider[id]=data;return muslider},start:function(id){id=find_instance(id);var data=muslider[id];if(data.timer!=0){clearInterval(data.timer)}data.timer=setInterval(function(){$.fn.muslider("next",id)},data.options.animation_interval);muslider[id]=data;return muslider},stop:function(id){id=find_instance(id);var data=muslider[id];clearInterval(data.timer);muslider[id]=data;return muslider},destroy:function(){id=find_instance($(this).attr("data-id"));var data=muslider[id];data.prev.off();data.next.off();$.fn.muslider("stop",id);$.removeData(data,this.name);this.removeClass(this.name);this.unbind();this.element=null}};function load_image(data){var $actual_slide=$("#slide"+data.instance+"_"+data.current),$image=$actual_slide.find("img");if($image.length>0){if($image.attr("src")!=$image.attr("data-src")){$image.attr("src",$image.attr("data-src"))}if(data.options.ratio=="adjust"){var screenImage=$image;var theImage=new Image;theImage.onload=function(){var imageWidth=theImage.width,imageHeight=theImage.height,slider_ratio=imageHeight/imageWidth,$slider=data.slider,$slide=data.slide,calc_width=data.calc_width,calc_height=Math.round(calc_width*slider_ratio);$actual_slide.css({height:calc_height});$image.css({height:calc_height});$slider.css({height:calc_height})};theImage.src=screenImage.attr("src")}if($actual_slide.find(".caption").length==0&&$image.attr("title")!=undefined&&$image.attr("title")!=""){$actual_slide.append("<div class='caption'><p>"+$image.attr("title")+"</p></div>").promise().done(function(){var bottom_position=$actual_slide.find(".caption").outerHeight(true);$actual_slide.find(".caption").css({bottom:-bottom_position}).delay(800).animate({bottom:0},300)})}}}function animate_caption(data){var $actual_slide=$("#slide"+data.instance+"_"+data.current);if($actual_slide.find(".caption").length>0){var bottom_position=$actual_slide.find(".caption").outerHeight(true);$actual_slide.find(".caption").css({bottom:-bottom_position}).delay(800).animate({bottom:0},300)}}function animate_slide(data,actual,dir){var $actual_slide=$("#slide"+data.instance+"_"+data.current),$previous_slide=$("#slide"+data.instance+"_"+actual),$options=data.options,calc_width=data.calc_width,calc_height=data.calc_height,moveleft=0,movetop=0;if(dir=="n"){moveleft=calc_width+data.margin;movetop=calc_height+data.margin}else if(dir=="p"){moveleft=-(calc_width+data.margin);movetop=-(calc_height+data.margin)}switch($options.animation_type){case"horizontal":$actual_slide.css({left:moveleft}).show();$previous_slide.animate({left:-moveleft},$options.animation_duration,function(){$previous_slide.hide().toggleClass("active")});$actual_slide.animate({left:0},$options.animation_duration,function(){$(this).toggleClass("active")});break;case"vertical":$actual_slide.css({top:movetop}).show();$previous_slide.animate({top:-movetop},$options.animation_duration,function(){$previous_slide.hide().toggleClass("active")});$actual_slide.animate({top:0},$options.animation_duration,function(){$(this).toggleClass("active")});break;case"fade":$previous_slide.fadeOut($options.animation_duration).toggleClass("active");$actual_slide.fadeIn($options.animation_duration,function(){$(this).toggleClass("active")});break}}function stop_multimedia(id,actual){var $previous_slide=$("#slide"+id+"_"+actual),$multimedia_html5;if($previous_slide.children().is("audio,video")){$multimedia_html5=$previous_slide.children("audio,video");if($multimedia_html5[0].paused===false){$multimedia_html5[0].pause()}}}function find_instance(id){if(typeof id==="string"){var position=id.indexOf("_");if(position!=-1){id=id.substr(position+1)}}return id}function innum(dim,parent_dim){var resp_dim=dim;if(typeof dim==="string"){var position=dim.indexOf("%");if(position!=-1){var dim1=parseInt(dim.slice(0,-1))/100,resp_dim=parseInt(parent_dim*dim1)}}return resp_dim}function resize_slider(data){var $slider=data.slider,$slide=data.slide,$options=data.options,max_width=data.options.max_width,max_height=data.options.max_height,min_width=data.options.min_width,min_height=data.options.min_height,slider_ratio=data.slider_ratio,calc_width=data.calc_width,calc_height=data.calc_height,scrollbar_width=40;calc_width=Math.min($slider.parent().width(),$(window).width()-scrollbar_width);if($options.ratio=="initial"){slider_ratio=getCookie("muslider_ratio")}else if($options.ratio=="continuous"){var new_width=innum($options.width,$(window).width()),new_height=innum($options.height,$(window).height());slider_ratio=new_height/new_width}else if(data.options.ratio=="adjust"){var $actual_slide=$("#slide"+data.instance+"_"+data.current),$image=$actual_slide.find("img");var screenImage=$image;var theImage=new Image;theImage.onload=function(){var imageWidth=theImage.width,imageHeight=theImage.height,slider_ratio=imageHeight/imageWidth,calc_height=Math.round(calc_width*slider_ratio);$actual_slide.css({height:calc_height});$image.css({height:calc_height});$slider.css({height:calc_height})};theImage.src=screenImage.attr("src")}var calc_height=Math.round(calc_width*slider_ratio);if(max_width>0&&calc_width>max_width){calc_width=max_width;calc_height=Math.round(calc_width*slider_ratio);if(max_height>0&&calc_height>max_height){calc_height=max_height}}if(max_height>0&&calc_height>max_height){calc_height=max_height;calc_width=Math.round(calc_height/slider_ratio);if(max_width>0&&calc_width>max_width){calc_width=max_width}}if(calc_width<min_width){calc_width=min_width;calc_height=Math.round(calc_width*slider_ratio);if(calc_height<min_height){calc_height=min_height}}if(calc_height<min_height){calc_height=min_height;calc_width=Math.round(calc_height/slider_ratio);if(calc_width<min_width){calc_width=min_width}}$slide.css({width:calc_width,height:calc_height});$slide.children("img,video,iframe").css({width:calc_width,height:calc_height});$slider.css({width:calc_width,height:calc_height});data.calc_width=calc_width;data.calc_height=calc_height;data.slide=$slide;data.slider=$slider;return data}$(window).resize(function(){for(i=0;i<instance;i++){$.fn.muslider("resize",i)}});function setCookie(name,value,days){if(days){var date=new Date;date.setTime(date.getTime()+days*24*60*60*1e3);var expires="; expires="+date.toGMTString()}else var expires="";document.cookie=name+"="+value+expires+"; path=/"}function getCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" ")c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length)}return null}function deleteCookie(name){setCookie(name,"",-1)}$.fn.muslider=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof method==="object"||!method){return methods.init.apply(this,arguments)}else{$.error("Method "+method+" does not exist on jQuery.muslider")}}})(jQuery);